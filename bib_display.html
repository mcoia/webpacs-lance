<!--{toplogo}-->
<!--{ifbibdisplay}-->
<!--{xif}-->
<!--{catedit}-->

<div id="bibDisplayBody">
<div class="navigationRowRecord">
<!--{navrow}-->
<!--{innreach}-->
</div>
<div id="bibDisplayContent">
<div class="bibSearch">
<!--{searchtool}-->
<div class="bibSearchHistory">
<!--{searchhistory}-->
</div>
</div><!-- bibSearch -->

<div class="bibPager">
<!--{pager}-->
</div>

<div class="bibClear"></div>

<div class="bibDisplayJacket">
<!--{bibimage}-->
<div class="bibMedia">
<!--{media}-->
</div>
<div id="googlebooks" name="googlebooks"></div>
</div>

<div class="bibDisplayContentMain">

<!--{recordinfo:a}-->

<h1 class="bibDisplayTitle">
<!--{recordinfo:t}-->
</h1>

<!--{recordinfo:pe}-->

<!--{ifhaspatrate}-->
<div class="bibDisplayRatings">
<!--{ratings}-->
</div>
<!--{xif}-->

<!--{booking}-->
<!--{holdingslink}-->
<div class="testlinkeddocs">
<!--{linkeddocs}-->
</div>
<div class="bibDisplayUrls">
<!--{URLS}-->
</div>

<!--{bloblinks}-->
<!--{imagelinks}-->
<!--{artthumb}-->
<!--{xmlframe}-->
<!--{holds}-->
<!--{holdings}-->

<div class="bibDisplayItems">
<div class="bibDisplayItemsMain">
<!--{items}-->

<!--{ifTOC}-->
<!--{TOC}-->
<!--{xif}-->

<a href="#here" name=smsbutton id=smsbutton onClick="showsms();return false;">
<div id="smsfeatures" class="resourceButton">
    <span class="button">
    <img src="/screens/ico_phone.png">
        <span class="buttonText">Text call number</span>
    </span>
</div>
</a>
       
    <!-- just a placeholder for the sms form -->
    <div id='sms' style="visibility:hidden;display:none">
    </div>

</div>
</div>

<!--{orders}-->

<div class="bibDisplayContentMore">
<!--{recordinfo:#}-->
</div>

<div class="bibDisplayContentMore bibDisplayReviews">
<div class="bibDisplayPermLink actionButtonArea">
<!--{recordlink}-->
</div>
<!--{patronreviewsfull}-->

</div>

</div>


</div><!-- close bibDisplayContent -->
<div class="clear"></div>
</div><!-- close bibDisplayBody -->
<!--{botlogo}-->


    <!-- a quick script to hide the SMS menu if there are no items. same as the javascript in the SMS form, but it's really just to see if the items exist.  If they don't, we hide the buttons -->
       <script>
       var f = document.getElementById('bib_detail');
       try { 
        var itms = document.getElementById('bib_items');
        var tr = itms.getElementsByTagName('TR');
        for(i = 1; i < tr.length; i++) {
         var x=tr[i].getElementsByTagName('TD');
         if (x.length == 3) {
          var loc = x[0].innerHTML.replace(/(<([^>]+)>|&nbsp;)/ig,"");
          var call = x[1].innerHTML.replace(/(<([^>]+)>|&nbsp;)/ig,"");
          var status = x[2].innerHTML.replace(/(<([^>]+)>|&nbsp;)/ig,"");
         }
        }
       } catch (e) {
         document.getElementById('smsfeatures').style.visibility='hidden';
       }

    </script>

<script type='text/javascript'> 
    var ProcessResults = function(bookInfo) {
        var buttonImg = "<img src='/screens/googlebutton.gif' alt='Google Preview'>"
        var textGBS = "";
        for (ISBN in bookInfo) {
            var b = bookInfo[ISBN];
            var googleButton = "<a href='" + b.preview_url + "' target='blank'>" + buttonImg;
            //form the text of Google Book contents
            if (b && (b.preview == "full")) {
                //textGBS = "Full Text";
                //"Google Book Search";
                document.getElementById("googlebooks").innerHTML = googleButton
            }
            else if (b && (b.preview == "partial")) {
                //textGBS = "(Limited preview)"
                //"Preview at Google Book Search";
                document.getElementById("googlebooks").innerHTML = googleButton
            }
            else if (b && (b.preview == "noview")) {
                //"Preview at Google Book Search";
                if (b.thumbnail_url != undefined){
                document.getElementById("googlebooks").innerHTML = bookJacket + "<a href='" + b.preview_url + "'>" + buttonImg + "</a>"
                }
            }
            else {
                //document.getElementById("googlebooks").innerHTML = "None available.";
            }
    }
}
</script>

<script type='text/javascript'>
       
var ISBN = $(".bibInfoLabel:contains('ISBN')").siblings(".bibInfoData").text().replace(/[^0123456789]/g,"")

var cburl = "http://books.google.com/books";
// Retrieve the info for these bibkeys
var api_url = cburl + "?jscmd=viewapi&bibkeys=ISBN:" + ISBN;
var s = document.createElement("script");
s.setAttribute("type", "text/javascript");
//alert("searching for: " + ISBN);
s.setAttribute("src", "http://books.google.com/books?jscmd=viewapi&bibkeys=ISBN:" + ISBN + "&callback=ProcessResults");
document.documentElement.firstChild.appendChild(s);
//alert (api_url);

</script>
